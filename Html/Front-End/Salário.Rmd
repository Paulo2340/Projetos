---
title: "Análise Salarial e Profissional"
author: "Paulo Augusto"
date: "`r format(Sys.Date(), '%d %B %Y')`"
output: 
  html_document :
    toc : true
    toc_float : true
params:
  area : Front-end
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```

```{r data, include = FALSE}
library(dplyr)
library(ggplot2)
library(knitr)
salario <- read.csv("salarios.csv", encoding = "UTF-8")
salario <- salario %>% select(-X)
salario$Salário.Máximo <- as.numeric(sub(",00", '', salario$Salário.Máximo)) * 1000
salario$Salário.Base <- as.numeric(sub(",00", '', salario$Salário.Base)) * 1000
salario <- salario %>% mutate(Salário.Médio = (Salário.Máximo + Salário.Base)/2)
salario$Nível <- sub("2 a 4 anos de experiência", " ", salario$Nível)
salario$Nível <- sub("4 a 6 anos de experiência", " ", salario$Nível)
salario$Nível <- sub("Mais de 6 anos de experiência"," ",  salario$Nível)
salario$Nível <- sub("0 a 2 anos de experiência", " ",  salario$Nível)
```
# Objetivos

  A Nossa intenção é fazer uma análise sobre o salário da área de `r params$area` e sobre os contratos e níveis desta área. Falaremos sobre : 
  
- Média Salarial
  - Média Mínima
  - Média Máxima
  - Média Salarial (Média do Mínimo e Máximo)
- Proporção de Cada Contrato com o total de Vagas
- Distribuição Salarial por Cada nível
  - Média Mínima
  - Média Máxima
  - Média Salarial (Média do Mínimo e Máximo)


  Primeiro, antes de tudo, quero que tenha noção de onde peguei as vagas, que foi do site [geek hunter](https://www.geekhunter.com.br/vagas).


## Preparaçao dos Dados

  A primeira coisa que você tem que ter noção é da tabela base na qual será retirada as informações, que está nesta tabela aqui, chamada `salario`. Só será mostrado 4 linhas da tabela, para poder entender.

```{r}
kable(head(salario, 4))
```

  Já que temos a intenção de fazer uma análise só sobre a área `r params$area`, iremos pegar, da tabela `salario` apenas as vagas que se referem a esta área. Aqui um exemplo da tabela filtrada com 5 linhas
```{r}
limpo <- salario %>% filter(Área == params$area)
kable(head(limpo, 5))
```

## 1 Média Salarial

  Agora, nossa intenção é descobrir a média salarial mínima, máxima e média. Como foi visto antes, havia duas colunas que se referiam ao salário, o `Salário.Base` e o `Salário.Máximo`. Se for ver no site, eles dão um intervalo, que é o mínimo que você receberá caso consiga o emprego, e o máximo que pode receber. Então explicaremos essas duas colunas isoladamente, e depois criaremos uma sobre o salário médio
  
### 1.1 Média Salarial Mínima

```{r, fig.dim=c(12, 10)}
limpo1 <- limpo %>% group_by(Contrato, Nível) %>% summarise(Media = mean(Salário.Base))
limpo1[5:12, ] %>% ggplot(aes(Nível, Media, fill = Nível)) + geom_col() + coord_flip() + facet_grid(Contrato~.) + theme_bw() + theme(legend.position = "none") + geom_text(aes(label = round(Media), hjust = -0.25), size = 3)
```

Aqui podemos ver as médias salárias mínimas para cada nível, baseada em cada contrato. Agora, vamos para a média Salarial Máxima

### 1.2 Média Salarial Máxima

Agora veremos as médias salárias máximas da área de `r params$area`

```{r, fig.dim=c(12,10)}
limpo1 <- limpo %>% group_by(Contrato, Nível) %>% summarise(Media = mean(Salário.Máximo))
limpo1[5:12, ] %>% ggplot(aes(Nível, Media, fill = Nível)) + geom_col() + coord_flip() + facet_grid(Contrato~.) + theme_bw() + theme(legend.position = "none") + geom_text(aes(label = round(Media), hjust = -0.25), size = 3)
```

### 1.3 Média Salarial Média

```{r, fig.dim=c(12, 10)}
limpo1 <- limpo %>% group_by(Contrato, Nível) %>% summarise(Media = mean(Salário.Médio))
limpo1[5:12, ] %>% ggplot(aes(Nível, Media, fill = Nível)) + geom_col() + coord_flip() + facet_grid(Contrato~.) + theme_bw() + theme(legend.position = "none") + geom_text(aes(label = round(Media), hjust = -0.25), size = 3)
```

Vimos todas a Média salarial de todas as formas, na forma mínima, máxima e média. Então, agora iremos para outros tópicos.

## 2 Proporção de Cada Contrato com o total de Vagas

Agora queremos ver a proporção da quantidade de cada contrato com o total. Por exemplo, se a maioria das vagas de emprego são do Tipo CLT ou PJ.

```{r}
limpo %>% filter(Contrato %in% c("CLT", "PJ"))%>% count(vars = Contrato) %>% mutate(proporcao = n / sum(n) * 100) %>% ggplot(aes(x = "", y = n, fill = vars)) + geom_col() + theme_void() + coord_polar(theta = "y", start = 0) + geom_text(aes(label = paste(round(proporcao, 2), "%")))
```

## 3 Distribuição Salarial por Cada nível

Agora que temos noção da proporção das coisas, iremos ver a distribuição salarial da área de `r params$area` por nível

### 3.1 Salário Mínimo

Agora queremos ter noção da distribuição Mínima. Já foi demonstrado antes mais ou menos a média, mas queremos ver de uma outra forma.

```{r}
ggplot(limpo, aes(Nível, Salário.Base, fill = Nível)) + geom_boxplot() + theme_bw()
kable(limpo %>% group_by(Nível) %>% summarise("1° Quartil" = quantile(Salário.Base, 0.25, na.rm = TRUE), "Mediana" = median(Salário.Base, na.rm = TRUE), "3° Quartil" = quantile(Salário.Base, 0.75, na.rm = TRUE)))
```

Aqui podemos ver a distribuição Salarial Mínima Por cada nível dentro da tabela.

### 3.2 Salário Máximo

Agora queremos a mesma coisa que antes, mas agora, para o salário Máximo

```{r}
ggplot(limpo, aes(Nível, Salário.Máximo, fill = Nível)) + geom_boxplot() + theme_bw()
kable(limpo %>% group_by(Nível) %>% summarise("1° Quartil" = quantile(Salário.Máximo, 0.25, na.rm = TRUE), "Mediana" = median(Salário.Máximo, na.rm = TRUE), "3° Quartil" = quantile(Salário.Máximo, 0.75, na.rm = TRUE)))
```
Agora temos esta visão para o salário Máximo

### 3.3 Salário Médio

Agora partiremos para o salário médio

```{r}
ggplot(limpo, aes(Nível, Salário.Médio, fill = Nível)) + geom_boxplot() + theme_bw()
kable(limpo %>% group_by(Nível) %>% summarise("1° Quartil" = quantile(Salário.Médio, 0.25, na.rm = TRUE), "Mediana" = median(Salário.Médio, na.rm = TRUE), "3° Quartil" = quantile(Salário.Médio, 0.75, na.rm = TRUE)))
```
